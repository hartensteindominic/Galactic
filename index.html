<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Autonomous AI Coder</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.min.js"></script>
    <style>
        body { font-family: 'Courier New', monospace; background: #0d1117; color: #58a6ff; padding: 20px; }
        #chat-box { height: 400px; border: 1px solid #30363d; overflow-y: scroll; padding: 10px; margin-bottom: 10px; background: #161b22; }
        input { width: 80%; padding: 10px; background: #0d1117; border: 1px solid #30363d; color: white; }
        button { padding: 10px; cursor: pointer; background: #238636; color: white; border: none; }
        .status { font-size: 0.8em; color: #8b949e; }
    </style>
</head>
<body>

    <h2>Autonomous AI Coder <span id="payment-status" class="status"></span></h2>
    <div id="chat-box"></div>
    <input type="text" id="user-input" placeholder="Describe the app you want built...">
    <button onclick="processRequest()">Send</button>

    <script>
        const ADMIN_WALLET = "0x02f93c7547309ca50EEAB446DaEBE8ce8E694cBb";
        const RATE = "100000000000000"; // 0.0001 ETH in Wei
        let web3;
        let userAccount;

        // Initialize Web3 and Wallet
        async function connectWallet() {
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                userAccount = accounts[0];
                startPaymentCycle();
            } else {
                alert("Please install MetaMask!");
            }
        }

        // Automated Payment Logic (Every 10 Minutes)
        function startPaymentCycle() {
            if (userAccount.toLowerCase() === ADMIN_WALLET.toLowerCase()) {
                document.getElementById('payment-status').innerText = "(Admin Mode: Free)";
                return;
            }

            setInterval(async () => {
                try {
                    await web3.eth.sendTransaction({
                        from: userAccount,
                        to: ADMIN_WALLET,
                        value: RATE
                    });
                    console.log("Payment successful");
                } catch (err) {
                    alert("Payment required to continue using AI.");
                    window.location.reload();
                }
            }, 600000); // 10 minutes
        }

        // The AI "Autonomous" Simulation
        async function processRequest() {
            const prompt = document.getElementById('user-input').value;
            logToChat("User: " + prompt);
            
            logToChat("AI: Analyzing and coding...");
            // In a real scenario, you'd fetch an LLM API here
            let code = `// Generated code for: ${prompt}\nconsole.log('App Initialized');`;
            
            logToChat("AI: Testing code for errors...");
            // Autonomous "Self-Learning" Logic
            let success = true; // Simulated test result
            if (success) {
                logToChat("AI: Code verified. Learning this pattern for future use.");
                saveToBrain(prompt, code);
            }

            logToChat("AI Output: <pre>" + code + "</pre>");
        }

        function logToChat(msg) {
            const box = document.getElementById('chat-box');
            box.innerHTML += `<div>${msg}</div>`;
            box.scrollTop = box.scrollHeight;
        }

        function saveToBrain(q, a) {
            localStorage.setItem('ai_brain_' + Date.now(), JSON.stringify({q, a}));
        }

        window.onload = connectWallet;
    </script>
</body>
</html>
